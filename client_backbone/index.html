<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/> 

<title> KiwiIRC </title>

<link rel="stylesheet" type="text/css" href="style.css" />

</head>
<body>
    <div id="kiwi">
        <div id="toolbar">
            <ul class="panellist channels"></ul>

            <div id="topic">
                <input type="text" />
            </div>
        </div>

        <div id="panels">
            <div class="panel_container container1"></div>
        </div>

        <div id="memberlists"></div>

        <div id="controlbox">
            <div class="input">
                <span class="nick"> </span>
                <div class="input_wrap"><input type="text" class="inp" /></div>
            </div>
        </div>
    </div>

    <script type="text/x-jquery-tmpl" id="tmpl_userbox">
        <div class="userbox">
            <a class="query">Message</a>
            <a class="info">Info</a>
        </div>
    </script>

    <script type="text/x-jquery-tmpl" id="tmpl_server_select">
        <div class="server_select">
            <div class="status"></div>

            <form>
                <div class="basic">
                    <label for="server_select_nick">Nickname</label>
                    <input type="text" class="nick" id="server_select_nick"> <br />

                    <button type="submit">Connect..</button> <br />
                    <a class="show_more">More</a>
                </div>

                <div class="more">
                    <label for="server_select_server">Server</label>
                    <input type="text" class="server" id="server_select_server"> <br />
                    <label for="server_select_channel">Channel</label>
                    <input type="text" class="channel" id="server_select_channel"> <br />
                </div>
            </form>
        </div>
    </script>

<script>

    function getQueryVariable(variable) {
        var query = window.location.search.substring(1);
        var vars = query.split('&');
        for (var i = 0; i < vars.length; i++) {
            var pair = vars[i].split('=');
            if (decodeURIComponent(pair[0]) == variable) {
                return decodeURIComponent(pair[1]);
            }
        }
    }

    window.onload = function () {

        // Common dependancies that are required at all times
        var scripts = [
            'jquery-1.7.1.min.js',
            'underscore-min.js',
            'backbone-git.js',
            'http://localhost:7778/socket.io/socket.io.js',
        ];

        // If in debug mode, load each development script
        if (getQueryVariable('debug')) {
            scripts = scripts.concat([
                'dev/app.js',
                'dev/model_application.js',
                'dev/model_gateway.js',
                'dev/model_member.js',
                'dev/model_memberlist.js',
                'dev/model_panel.js',
                'dev/model_panellist.js',
                'dev/model_channel.js',
                'dev/model_server.js',

                'dev/utils.js',
                'dev/view.js'
            ]);
        } else {
            scripts.push('kiwi.min.js');
        }


        // Run after all dependancies have been loaded
        function startApp () {    
            kiwi.app = new kiwi.model.Application({container: $('#kiwi')});
            kiwi.app.start();
        }


        // Load each script
        var cur_script = 0;
        function loadNextScript () {
            if (cur_script === scripts.length) {
                startApp();
                return;
            }

            var el = document.createElement('script');
            el.onload = loadNextScript;
            el.src = scripts[cur_script];
            document.getElementsByTagName('head')[0].appendChild(el);

            cur_script++;
        }

        // Start loading scripts
        loadNextScript();
    };
</script>
</body>
</html>